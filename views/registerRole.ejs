<!DOCTYPE html>
<html lang="en">
  
  <head>
    <title>Register Role</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/styles/admin-common.css" />
    
  </head>
  <body>
    <div style="width:100%;position:fixed;top:0;left:0;z-index:100;">
      <%- include("adminHeader", { username: typeof username !== 'undefined' ? username : null }); %>
    </div>
    <div class="register-role-main" style="margin-top:80px; display: flex; justify-content: center; align-items: flex-start; gap: 2.5rem; width: 100%; max-width: 1100px;">
      <!-- Left: Register Role Form -->
      <div class="register-role-container" style="margin-top:0; min-width: 340px; flex: 1;">
        <div class="register-role-title">Register New Role</div>
        <% if (typeof message !== 'undefined' && message) { %>
        <div class="<%= success ? 'success-message' : 'error-message' %>">
          <%= message %>
        </div>
        <% } %>
        <% if (typeof updateUser !== 'undefined' && updateUser) { %>
          <form class="register-role-form" action="/update-user/<%= updateUser._id %>" method="POST">
            <div class="input-group">
              <label for="username">Username</label>
              <input type="text" id="username" name="username" value="<%= updateUser.username %>" readonly />
            </div>
            <div class="input-group">
              <label for="role">Role</label>
              <input type="text" id="role" name="role" value="<%= updateUser.role %>" required />
            </div>
            <button class="register-btn" type="submit">Update Role</button>
            <a href="/register-role" style="margin-top:0.5rem; color:#ff512f; text-decoration:underline; display:inline-block;">Cancel</a>
          </form>
        <% } else { %>
          <form class="register-role-form" action="/register-role" method="POST">
            <div class="input-group">
              <label for="username">Username</label>
              <input
                type="text"
                id="username"
                name="username"
                placeholder="Enter username"
                required
                autocomplete="username"
              />
            </div>
            <div class="input-group">
              <label for="password">Password</label>
              <input
                type="password"
                id="password"
                name="password"
                placeholder="Enter password"
                required
                autocomplete="new-password"
              />
            </div>
            <div class="input-group">
              <label for="role">Role</label>
              <select id="role" name="role" required>
                <option value="">Select role</option>
                <option value="jc">JC</option>
                <option value="user">User</option>
              </select>
            </div>
            <button class="register-btn" type="submit">Register Role</button>
          </form>
        <% } %>
        <div class="register-role-footer">
          &copy; <%= new Date().getFullYear() %> ZEST2k25 Admin Panel
        </div>
      </div>
      <!-- Right: User List -->
      <div class="user-list-container" style="background:rgba(30,34,54,0.98); border-radius:18px; box-shadow:0 8px 32px 0 rgba(31,38,135,0.18); padding:2rem 1.5rem; min-width:340px; flex:1; max-width:420px;">
        <div style="font-size:1.4rem; font-weight:600; color:#43cea2; margin-bottom:1.2rem; text-align:center;">Registered Users</div>
        <% if (users && users.length > 0) { %>
          <table style="width:100%; border-collapse:collapse;">
            <thead>
              <tr style="background:#232946; color:#ffb347;">
                <th style="padding:0.6rem 0.3rem; font-size:1rem;">Username</th>
                <th style="padding:0.6rem 0.3rem; font-size:1rem;">Role</th>
                <th style="padding:0.6rem 0.3rem; font-size:1rem; text-align:center;">Actions</th>
              </tr>
            </thead>
            <tbody>
              <% users.forEach(function(user) { %>
                <tr style="border-bottom:1px solid #232946;">
                  <td style="padding:0.5rem 0.3rem; color:#fff; font-size:1rem;"> <%= user.username %> </td>
                  <td style="padding:0.5rem 0.3rem; color:#ffb347; font-size:1rem;"> <%= user.role %> </td>
                  <td style="padding:0.5rem 0.3rem; text-align:center;">
                    <!-- Update Icon (U) -->
                    <a href="/update-user/<%= user._id %>" title="Update" style="margin-right:0.7rem; text-decoration:none;">
                      <span style="display:inline-block; background:#43cea2; color:#fff; border-radius:50%; width:24px; height:24px; line-height:24px; text-align:center; font-weight:700; font-size:1rem; box-shadow:0 2px 6px 0 rgba(67,206,162,0.15);">U</span>
                    </a>
                    <!-- Delete Icon (X) -->
                    <a href="/delete-user/<%= user._id %>" title="Delete" style="text-decoration:none;" onclick="return confirm('Are you sure you want to delete this user?');">
                      <span style="display:inline-block; background:#ff512f; color:#fff; border-radius:50%; width:24px; height:24px; line-height:24px; text-align:center; font-weight:700; font-size:1rem; box-shadow:0 2px 6px 0 rgba(255,81,47,0.15);">X</span>
                    </a>
                  </td>
                </tr>
              <% }); %>
            </tbody>
          </table>
        <% } else { %>
          <div style="color:#ffb347; text-align:center; margin-top:1.5rem;">No users registered yet.</div>
        <% } %>
      </div>
    </div>
  </body>
</html>
